<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Tracking Orders</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    </head>
    <body class="container py-4">
        <h3 class="mb-4">Tracking Orders</h3>

        <div class="table-responsive">
            <table class="table table-bordered table-striped align-middle">
                <thead class="table-light">
                    <tr>
                        <th>No Order</th>
                        <th>No PO</th>
                        <th>Quotation</th>
                        <th>Tanggal Order</th>
                        <th>Deadline</th>
                        <th>Status</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="trackingTable"></tbody>
            </table>
        </div>

        <script>
            const orders = JSON.parse(localStorage.getItem("u2m_orders")) || [];
            const trackingTable = document.getElementById("trackingTable");

            function renderTracking() {
                trackingTable.innerHTML = "";
                orders.forEach((o, index) => {
                    trackingTable.innerHTML += `
          <tr>
            <td>${o.orderNumber}</td>
            <td>${o.poNumber}</td>
            <td>${o.quotationNumber}</td>
            <td>${o.date}</td>
            <td>${o.deadline}</td>
            <td><span class="badge bg-${statusColor(o.status)}">${o.status}</span></td>
            <td>
              <select class="form-select form-select-sm" onchange="updateStatus(${index}, this.value)">
                <option value="Dalam Proses" ${o.status === "Dalam Proses" ? "selected" : ""}>Dalam Proses</option>
                <option value="Produksi" ${o.status === "Produksi" ? "selected" : ""}>Produksi</option>
                <option value="Dikirim" ${o.status === "Dikirim" ? "selected" : ""}>Dikirim</option>
                <option value="Selesai" ${o.status === "Selesai" ? "selected" : ""}>Selesai</option>
              </select>
            </td>
          </tr>
        `;
                });
            }

            function updateStatus(index, newStatus) {
                orders[index].status = newStatus;
                localStorage.setItem("u2m_orders", JSON.stringify(orders));
                renderTracking();
            }

            function statusColor(status) {
                switch (status) {
                    case "Dalam Proses":
                        return "primary";
                    case "Produksi":
                        return "warning";
                    case "Dikirim":
                        return "info";
                    case "Selesai":
                        return "success";
                    default:
                        return "secondary";
                }
            }

            renderTracking();
        </script>
    </body>
</html>
